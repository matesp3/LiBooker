@page "/contact"
@inject IJSRuntime JSRuntime

<div class="container fade-in my-4">
    
    <!-- 1. Header Section -->
    <div class="text-center mb-5">
        <h1 class="display-5 fw-bold text-brand">Get in Touch</h1>
        <p class="text-muted fs-5">We'd love to hear from you. Here is how you can reach us.</p>
    </div>

    <!-- 2. Contact Cards Grid -->
    <div class="row g-4 mb-5">
        <!-- Address Card -->
        <div class="col-md-4">
            <div class="contact-card h-100">
                <div class="icon-circle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                    </svg>
                </div>
                <h5>Visit Us</h5>
                <p>
                    @this.companyInfo.AddressLine1<br>
                    @this.companyInfo.AddressLine2<br>
                    @this.companyInfo.Country
                </p>
            </div>
        </div>

        <!-- Phone Card -->
        <div class="col-md-4">
            <div class="contact-card h-100">
                <div class="icon-circle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M1.885.511a1.745 1.745 0 0 1 2.61.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511z"/>
                    </svg>
                </div>
                <h5>Call Us</h5>
                <div class="d-flex flex-column align-items-center gap-2">
                    @foreach (var phone in this.companyInfo.Phones)
                    {
                         <div class="d-flex align-items-center gap-2">
                            <span class="@(phone.IsSecondary ? "text-muted small" : "")">@phone.Label: @phone.Number</span>
                            <button class="btn-copy-small" @onclick='() => CopyToClipboard(phone.Number)' title="Copy number">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                                </svg>
                            </button>
                        </div>
                    }
                </div>
            </div>
        </div>

        <!-- Email Card -->
        <div class="col-md-4">
            <div class="contact-card h-100">
                <div class="icon-circle">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
                    </svg>
                </div>
                <h5>Email Us</h5>
                <div class="d-flex flex-column align-items-center gap-2">
                    @foreach (var email in this.companyInfo.Emails)
                    {
                        <div class="d-flex align-items-center gap-2">
                            <span>@email.Label: @email.Address</span>
                             <button class="btn-copy-small" @onclick='() => CopyToClipboard(email.Address)' title="Copy email">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                                    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                                </svg>
                            </button>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- 3. Hours & Info Section -->
    <div class="row g-4">
        <!-- Opening Hours -->
        <div class="col-md-6">
            <div class="info-box h-100">
                <h4 class="mb-4">Opening Hours</h4>
                <div class="hours-list">
                    @foreach (var hours in companyInfo.OpeningHours)
                    {
                         <div class="d-flex justify-content-between mb-2 pb-2 @(hours.IsLast ? "" : "border-bottom") @(hours.IsClosed ? "text-muted" : "")">
                            <span>@hours.Days</span>
                            <span class="@(hours.IsClosed ? "" : "fw-bold")">@hours.Time</span>
                        </div>
                    }
                </div>
            </div>
        </div>

        <!-- Fake Map / Location Context -->
        <div class="col-md-6">
            <div class="map-placeholder h-100">
                <div class="map-content">
                    <h5>Find us in the village center</h5>
                    <p>We are located right behind the Florian square. Parking is available in front of the building.</p>
                    <a href="@this.companyInfo.GoogleMapsLink" 
                       target="_blank" 
                       class="btn btn-outline-light mt-2">
                        Get Directions
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private CompanyInfo companyInfo = new();

    protected override void OnInitialized()
    {
        // Static data initialization. In wrapper class for clarity (no need to search in html)
        companyInfo = new CompanyInfo
        {
            AddressLine1 = "Námestie sv. Floriána (Florian Square)",
            AddressLine2 = "Teplička nad Váhom, 013 01",
            Country = "Slovakia",
            GoogleMapsLink = "https://www.google.com/maps/search/?api=1&query=Námestie+sv.+Floriána,+Teplička+nad+Váhom",
            Phones = new List<PhoneInfo>() 
            {
                new PhoneInfo { Label = "Main", Number = "+421 214 555 134" },
                new PhoneInfo { Label = "Support", Number = "+421 245 555 678", IsSecondary = true }
            },
            Emails = new List<EmailInfo>()
            {
                new EmailInfo { Label = "General", Address = "info@libooker.local" },
                new EmailInfo { Label = "Support", Address = "help@libooker.local" }
            },
            OpeningHours = new List<HoursInfo>()
            {
                new HoursInfo { Days = "Monday - Friday", Time = "08:00 - 20:00" },
                new HoursInfo { Days = "Saturday", Time = "09:00 - 15:00" },
                new HoursInfo { Days = "Sunday", Time = "Closed", IsClosed = true, IsLast = true }
            }
        };
    }

    private async Task CopyToClipboard(string text)
    {
        await JSRuntime.InvokeVoidAsync("clipboardCopy.copyText", text);
    }

    // --- Private Helper Classes ---
    
    private class CompanyInfo
    {
        public string AddressLine1 { get; set; } = "";
        public string AddressLine2 { get; set; } = "";
        public string Country { get; set; } = "";
        public string GoogleMapsLink { get; set; } = "";
        public List<PhoneInfo> Phones { get; set; } = new();
        public List<EmailInfo> Emails { get; set; } = new();
        public List<HoursInfo> OpeningHours { get; set; } = new();
    }

    private class PhoneInfo 
    {
        public string Label { get; set; } = "";
        public string Number { get; set; } = "";
        public bool IsSecondary { get; set; }
    }

    private class EmailInfo
    {
         public string Label { get; set; } = "";
         public string Address { get; set; } = "";
    }

    private class HoursInfo
    {
        public string Days { get; set; } = "";
        public string Time { get; set; } = "";
        public bool IsClosed { get; set; }
        public bool IsLast { get; set; }
    }
    
}